easyblock = 'EB_FFTW'
name = 'FFTW.MPI'
version = '3.3.10'

homepage = 'https://www.fftw.org'
description = """FFTW is a C subroutine library for computing the discrete Fourier transform (DFT)
in one or more dimensions, of arbitrary input size, and of both real and complex data."""

toolchain = {'name': 'gompi', 'version': '2022.05'}
toolchainopts = {'pic': True}

source_urls = [homepage]
sources = ['fftw-%(version)s.tar.gz']
checksums = ['56c932549852cddcfafdab3820b0200c7742675be92179e59e6215b340e26467']

dependencies = [('FFTW', '3.3.10')]

with_openmp = False
with_threads = False
with_quad_prec = False

postinstallcmds = [
    'rm %(installdir)s/lib/libfftw3.* %(installdir)s/lib/libfftw3[lf].*',
    'rm -rf %(installdir)s/lib/pkgconfig %(installdir)s/lib/cmake',
    'rm -rf %(installdir)s/bin %(installdir)s/share',
]

runtest = 'check'

sanity_check_paths = {
    'files': ['include/fftw3%s' % x for x in ['-mpi.f03', '-mpi.h', '.f', '.f03',
		                              '.h', 'l-mpi.f03', 'l.f03', 'q.f03']] +
             ['lib/libfftw3%s_mpi.a' % (x) for x in ['', 'f', 'l']],
    'dirs': [],
}

moduleclass = 'numlib'
